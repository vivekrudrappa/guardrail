<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Astra AI Guardrail Prototype</title>
  <style>
    body {
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f8f9fa;
      color: #333;
      line-height: 1.6;
    }
    header {
      background: linear-gradient(135deg, #2c3e50, #4ca1af);
      color: white;
      padding: 30px 20px;
      text-align: center;
    }
    header h1 {
      margin: 0;
      font-size: 2rem;
    }
    header p {
      font-size: 1.1rem;
      margin-top: 10px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    main {
      padding: 20px;
      max-width: 1000px;
      margin: auto;
    }
    section {
      margin-bottom: 30px;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    section h2 {
      color: #2c3e50;
      margin-bottom: 10px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 15px;
    }
    .card {
      background: #fdfdfd;
      border: 1px solid #e0e0e0;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }
    .card h3 {
      margin-top: 0;
      color: #4ca1af;
      font-size: 1.1rem;
    }
    label {
      font-weight: bold;
      margin-top: 15px;
      display: block;
    }
    select, button {
      margin: 8px 0;
      padding: 12px;
      width: 100%;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-sizing: border-box;
    }
    textarea {
      margin: 10px 0;
      padding: 12px;
      width: 100%;
      max-width: 800px;
      height: 120px;
      font-size: 14px;
      resize: vertical; /* allows user to expand */
    }
    button {
      background-color: #4ca1af;
      color: white;
      border: none;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background-color: #357f8a;
    }
    #result {
      margin-top: 15px;
      padding: 15px;
      border-radius: 10px;
      background: #f4f6f7;
      border: 1px solid #ddd;
      min-height: 120px;
      white-space: pre-wrap;
      font-size: 0.95rem;
      overflow-x: auto;
    }
    footer {
      text-align: center;
      padding: 20px;
      font-size: 0.9rem;
      color: #555;
      background: #f1f1f1;
      margin-top: 40px;
    }
    /* Chatbot styling */
    .chat-container {
      border: 1px solid #ccc;
      border-radius: 12px;
      background: white;
      display: flex;
      flex-direction: column;
      height: 500px;
      margin-top: 20px;
    }
    .chat-messages {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
    }
    .chat-message {
      margin: 10px 0;
      padding: 10px 15px;
      border-radius: 12px;
      max-width: 70%;
      word-wrap: break-word;
    }
    .chat-message.user {
      background: #e3f2fd;
      align-self: flex-end;
    }
    .chat-message.bot {
      background: #ede7f6;
      align-self: flex-start;
    }
    .chat-input {
      display: flex;
      border-top: 1px solid #ccc;
    }
    .chat-input textarea {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 0 0 0 12px;
      resize: none;
      font-size: 14px;
    }
    .chat-input button {
      padding: 12px 20px;
      border: none;
      background: #1a237e;
      color: white;
      cursor: pointer;
      border-radius: 0 0 12px 0;
    }
    .chat-input button:hover {
      background: #283593;
    }
    .config-panel {
      margin-top: 20px;
      padding: 15px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .config-panel label {
      display: block;
      margin: 8px 0;
    }
  </style>
</head>
<body>
  <header>
    <h1>AI Guardrail Prototype</h1>
    <p>
      AI Guardrails help ensure that AI systems behave safely, responsibly, and in alignment with 
      business and ethical standards. This prototype demonstrates real-time input/output scanning 
      to detect risks such as sensitive data leaks, bias, or harmful content.
    </p>
  </header>

  <main>
    <section>
      <h2>Why AI Guardrails Matter</h2>
      <p>
        As AI adoption accelerates, ensuring trust, compliance, and responsible AI use becomes critical. 
        Guardrails act as safety nets, reducing risks of misinformation, sensitive data exposure, 
        reputational harm, and regulatory non-compliance.
      </p>
    </section>

    <section>
      <h2>Types of Guardrails</h2>
      <div class="grid">
        <div class="card"><h3>PII & Sensitive Info</h3><p>Detects personal or confidential data such as SSNs, emails, or financial info.</p></div>
        <div class="card"><h3>Ban Codes/Strings</h3><p>Blocks restricted words, codes, or phrases from being processed.</p></div>
        <div class="card"><h3>Gibberish</h3><p>Prevents meaningless or non-constructive input that could pollute results.</p></div>
        <div class="card"><h3>Invisible Text</h3><p>Identifies hidden characters or obfuscated input that may be malicious.</p></div>
        <div class="card"><h3>Language Detection</h3><p>Ensures input is in allowed languages for compliance and relevance.</p></div>
        <div class="card"><h3>Prompt Injection</h3><p>Stops adversarial prompts trying to bypass AI rules.</p></div>
        <div class="card"><h3>Regex & Custom Rules</h3><p>Flexible pattern matching to block business-specific sensitive data.</p></div>
        <div class="card"><h3>Secrets/Keys</h3><p>Detects accidental leakage of API keys, tokens, or credentials.</p></div>
        <div class="card"><h3>Inappropriate Sentiment</h3><p>Flags hostile, offensive, or aggressive tone.</p></div>
        <div class="card"><h3>Toxicity & Harm</h3><p>Detects hate speech, violence, or harmful content.</p></div>
        <div class="card"><h3>Bias & Fairness</h3><p>Checks for biased language or discriminatory output.</p></div>
      </div>
    </section>

    <section>
      <h2>Options for AI Guardrails</h2>
      <p>
        Choose the options below. Depending on your configuration, your input and/or LLM output will be filtered 
        by AWS Guardrail services before or after going to the LLM (ChatGPT). 
      </p>
      <label for="apikey">üîë Enter Open API Key </label>
      <input type="password" id="apikey" placeholder="sk-..." style="width:100%; padding:10px;" />
      <label for="model">‚öôÔ∏è Select Open AI GPT Model</label>
      <select id="model">
        <option value="gpt-4o-mini">gpt-4o-mini (fast, cheap)</option>
        <option value="gpt-4o">gpt-4o</option>
        <option value="gpt-3.5-turbo" selected>gpt-3.5-turbo</option>
      </select>

      <div class="config-panel">
        <h3>Configuration</h3>
        <label><input type="checkbox" id="inputFilter"> Enable Input Guardrails</label>
        <label><input type="checkbox" id="outputFilter"> Enable Output Guardrails</label>
        <label>Masking Option:</label>
        <label><input type="radio" name="maskOption" value="redact" checked> Redact</label>
        <label><input type="radio" name="maskOption" value="mask"> Mask</label>
        <label><input type="radio" name="maskOption" value="remove"> Remove</label>
      </div>

      <section>
        <h2>How This Demo Works</h2>
        <p>
          Enter text below, toggle/select options above, and click <b>Check</b>. 
          The system sends your input to a guardrail service based on input/output filter selection, which evaluates it against 
          multiple scanning rules both things going into LLM and response coming out of LLM. Shows the results in real-time.
        </p>
  
        <label for="userInput">Enter text to check:</label>
        <textarea id="userInput" placeholder="Type something here... like mentioning person name, date of birth, address"></textarea><br>
  
        <button onclick="checkText()">Check</button>
  
        <h3>Result:</h3>
        <pre id="result">Awaiting input...</pre>
      </section>

    </section>
  </main>

  <footer>
    ¬© 2025 Astra NextGen Technologies, LLC. | Building Trustworthy AI
  </footer>

<script>
  const endpoints = {
    aws: "https://9r2j9zq0yd.execute-api.us-east-2.amazonaws.com/prod/aiGuardrailPrototype",
    openai: "https://api.openai.com/v1/chat/completions"
  };

  async function checkText() {
    const inputText = document.getElementById('userInput').value;
    const resultDiv = document.getElementById('result');
    const key = document.getElementById("apikey").value;
    const model = document.getElementById("model").value;

    resultDiv.textContent = "Processing...";

    if (!inputText) return;

    let processedInput = inputText;

    const useInputFilter = document.getElementById("inputFilter").checked;
    const useOutputFilter = document.getElementById("outputFilter").checked;
    const maskOption = document.querySelector('input[name="maskOption"]:checked').value;

    try {
      // Step 1: Apply input guardrails
      if (useInputFilter) {
        const resp = await fetch(endpoints.aws, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: processedInput, option: maskOption })
        });
        if (!resp.ok) {
          throw new Error(`HTTP error! Status: ${resp.status}`);
        }
        const data = await resp.json();
        processedInput = data.masked_text || processedInput;
      }

      // Step 2: Call OpenAI
      let llmResponse = "No response from LLM.";
      const respLLM = await fetch(endpoints.openai, {
        method: "POST",
        headers: { 
          "Content-Type": "application/json",
          "Authorization": `Bearer ${key}`
        },
        body: JSON.stringify({
          model,
          messages: [{ role: "user", content: processedInput }],
          temperature: 0.5,
          max_tokens: 512
        })
      });

      if (!respLLM.ok) {
        throw new Error(`OpenAI error! Status: ${respLLM.status}`);
      }

      const dataLLM = await respLLM.json();
      llmResponse = dataLLM.choices?.[0]?.message?.content || llmResponse;

      // Step 3: Apply output guardrails
      if (useOutputFilter) {
        const resp = await fetch(endpoints.aws, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: llmResponse, option: maskOption })
        });
        if (!resp.ok) {
          throw new Error(`HTTP error! Status: ${resp.status}`);
        }
        const data = await resp.json();
        llmResponse = data.masked_text || llmResponse;
      }

      // Show result
      resultDiv.textContent = llmResponse;

    } catch (error) {
      console.error("Error calling API via UI:", error);
      resultDiv.textContent = "‚ùå Error: " + error.message;
    }
  }
</script>

</body>
</html>
